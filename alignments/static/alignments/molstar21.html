<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>PDBe Molstar - Helper functions</title>
	
	 <!-- Required for IE11 -->
        <script src="https://cdn.jsdelivr.net/npm/babel-polyfill/dist/polyfill.min.js" defer></script>
        <!-- Web component polyfill (only loads what it needs) -->
        <script src="https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs/webcomponents-lite.js" charset="utf-8" defer></script>
        <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
        <script src="https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>

        <!-- d3.js dependency script -->
        <script src="https://cdn.jsdelivr.net/npm/d3@5.9.2" defer></script>

        <!-- PDB Topology Viewer Web-component JS 
        <script type="text/javascript" src="build/pdb-topology-viewer-component-2.0.1.js" defer></script>-->
		
	

 <!-- PDB Topology Viewer Web-component JS -->
        <script type="text/javascript" src="./pdb-topology-viewer-component-2.0.9.js" defer></script>
    
		
		
        
       

        <link rel="stylesheet" type="text/css" href="./pdbe-molstar-1.1.0-dev.5.css">
        <script type="text/javascript" src="./pdbe-molstar-component-1.1.0-dev.5.js"></script>
    <style>
      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
      }
      .msp-plugin ::-webkit-scrollbar-thumb {
          background-color: #474748 !important;
      }
      .viewerSection {
        padding-top: 10px;
      }
      .controlsSection {
        width: 200px;
        float: left;
        padding: 40px 0 0 0;
        margin-right: 30px;
      }
      .controlBox {
        border: 1px solid lightgray;
        padding: 10px;
        margin-bottom: 20px;
      }
	    #pdb-component {
				float:left;	
                position: relative;
                width: 500px;
                height: 500px;
            }
			
		 #topologyView1{
        float:left;
        width:500px;
        height: 500px;
        position:relative;
      }	
      #pdbeMolstarView {
        float:left;
        width:500px;
        height: 500px;
        position:relative;
      }
    </style>
  </head>

  <body>

    <div class="controlsSection">

      <h3>Canvas/ layout methods</h3>
      
      <div class="controlBox">
        <strong>Set Background</strong><br>
        <button onclick="viewerInstance.canvas.setBgColor({r:255, g:255, b:255})">White</button>&nbsp;
        <button onclick="viewerInstance.canvas.setBgColor({r:0, g:0, b:0})">Black</button><br><br>
        
        <strong>Toggle controls menu</strong><br>
        <button onclick="viewerInstance.canvas.toggleControls(false)">Hide</button>&nbsp;
        <button onclick="viewerInstance.canvas.toggleControls(true)">Show</button>&nbsp;
        <button onclick="viewerInstance.canvas.toggleControls()">Toggle</button><br><br>
        
        <strong>Toggle Fullscreen</strong><br>
        <button onclick="viewerInstance.canvas.toggleExpanded(true)">Show Fullscreen</button><br>
      </div>

      <h3>Visual Methods</h3>
      <div class="controlBox">
        <strong>Change representation visibility</strong><br>
        <button onclick="viewerInstance.visual.visibility({water:false})">Hide Water Visual</button>&nbsp;
        <button onclick="viewerInstance.visual.visibility({water:true})">Show Water Visual</button><br><br>

        <strong>Toggle Spin</strong><br>
        <button onclick="viewerInstance.visual.toggleSpin(true)">Rotate</button>&nbsp;
        <button onclick="viewerInstance.visual.toggleSpin(false)">Stop</button>&nbsp;
        <button onclick="viewerInstance.visual.toggleSpin()">Toggle</button><br><br>
        
        <strong>Focus</strong><br>
        <button onclick="viewerInstance.visual.focus([{entity_id: '27', start_residue_number: 14, end_residue_number: 18}])">Focus on Chain L2:14-18</button><br><br>

        <strong>Highlight</strong><br>
        <button onclick="viewerInstance.visual.highlight({ data: [{ entity_id: '27', start_residue_number: 14, end_residue_number: 18 }], color:{r:255,g:255,b:0},





 })">Highlight Chain L2:14-18</button>&nbsp;
        <button onclick="viewerInstance.visual.clearHighlight()">Clear Highlight</button><br><br>
        
       <strong>Selection</strong><br>
        <button onclick="viewerInstance2.visual.select({ data: [{ entity_id: '27', start_residue_number: 1, end_residue_number: 6, color:{r:255,g:255,b:0}, focus: true }]})">Select & Focus on Chain CC:1-6</button><br><br>
         <button onclick="
                var selectSections = [{entity_id: '27', focus: true},
                  {
                     
					 entity_id: '27',
                    start_residue_number: 1, 
                    end_residue_number: 68,
                    color:{r:255,g:0,b:255},
                    sideChain: false,
					
                  },
                  {entity_id: '27', start_residue_number: 69, end_residue_number: 127, color:{r:255,g:0,b:0}}, 
					{
					entity_id: '27',
					start_residue_number: 128,
					end_residue_number: 200,
					color:{r:99,g:122,b:200},
                   },

										{
					entity_id: '27',
					start_residue_number: 216,
					end_residue_number: 216,
					color:{r:100,g:100,b:0},
                   } 

					

                ];
          viewerInstance.visual.select({ data: selectSections, nonSelectedColor: {r:0,g:0,b:0}})">Select Domains of uL2</button><br><br>
          
          
          
       <button onclick="viewerInstance.visual.select({ data: [{entity_id: '27', color:{r:255,g:255,b:0}, focus:true}], nonSelectedColor: {r:255,g:255,b:255} })">Select & Focus on Chain L2</button><br><br>

        <button onclick="viewerInstance.visual.clearSelection()">Clear Selection</button><br><br>

     <strong>Set highlight / selection colour</strong><br>
        <button onclick="viewerInstance.visual.setColor({ highlight: {r:255,g:255,b:0} })">Yellow highlight</button>&nbsp;
        <button onclick="viewerInstance.visual.reset({ highlightColor: true })">Reset</button><br><br>
        <button onclick="viewerInstance.visual.setColor({ select: {r:255,g:0,b:0} })">Red selection</button>&nbsp;
        <button onclick="viewerInstance.visual.reset({ selectColor: true })">Reset</button><br><br>
        
        <strong>Reset Visual</strong><br>
        <button onclick="viewerInstance.visual.reset({ camera: true })">Camera</button>&nbsp;
        <button onclick="viewerInstance.visual.reset({ theme: true })">Theme</button>&nbsp;
        <button onclick="viewerInstance.visual.reset({ camera: true, theme: true })">Camera & Theme</button><br><br>

        <strong>Update data</strong><br>
        <button onclick="viewerInstance.visual.update({customData: { url: 'https://www.ebi.ac.uk/pdbe/coordinates/4v9d/chains?entityId=27&encoding=bcif', format: 'cif', binary:true }, assemblyId: '1', subscribeEvents: true})">Update data to create new visual</button><br>
         <strong>Update data1</strong><br>
        <button onclick="viewerInstance.visual.update({customData: { url: 'https://www.ebi.ac.uk/pdbe/coordinates/4v9d/residueRange?entityId=27&range=1-45:120-200&encoding=bcif', format: 'cif', binary:true }, assemblyId: '1', subscribeEvents: true})">Update data to create new visual</button><br>
      </div>
     <!--  https://webchem.ncbr.muni.cz/CoordinateServer 
	 https://www.ebi.ac.uk/pdbe/coordinates/doc.html  -->
    </div>

		
	   <!-- PDB Topology Viewer container -->
	   


	<script>
   //Instantiate plugin after DOM content is loaded


document.addEventListener('DOMContentLoaded', () => {

 var PdbeMolstarComponent = document.getElementById("PdbeMolstarComponent");


 var viewerInstance2 = PdbeMolstarComponent.viewerInstance;

console.log(PdbeMolstarComponent,viewerInstance2 );





	
      //Set options (Checkout available options list in the documentation)
      
       var options = {
      customData: { url: 'https://www.ebi.ac.uk/pdbe/coordinates/4v9d/chains?entityId=27&encoding=bcif', format: 'cif', binary:true },
      hideCanvasControls: ["expand", "selection", " animation"],
	  assemblyId: '1',

      hideControls: true,

      subscribeEvents: true
      };
		//viewerInstance.render(viewerContainer, options);
		viewerInstance2.visual.update({
customData: { url: 'https://www.ebi.ac.uk/pdbe/coordinates/4v9d/chains?entityId=27&encoding=bcif', format: 'cif', binary:true },
      hideCanvasControls: ["expand", "selection", " animation"],
	  assemblyId: '1',

      hideControls: true,

      subscribeEvents: true
    });
    


		

	 });
</script>
 

   <div id="topologyView1">
         <h4>PDBe Topology Web component Demo</h4>
            <pdb-topology-viewer id="topologyView" entry-id="4v9d" entity-id="27" subscribe-events="true"></pdb-topology-viewer>
        </div> 

<div id ="pdbeMolstarView">
<h4>PDBe  Molstar component Demo</h4>
        <pdbe-molstar id="PdbeMolstarComponent" molecule-id="1b23" hide-controls="true" subscribe-events="true" ></pdbe-molstar>
</div>
<script>
document.addEventListener('PDB.topologyViewer.click', (e)=>{
var pdbeMolstar=document.getElementById("PdbeMolstarComponent")
var molstar= pdbeMolstar.viewerInstance;


var chainId=e.eventData.chainId;
var entityId=e.eventData.entityId;
var residueNumber=e.eventData.residueNumber;
var types=e.eventData.type;

molstar.visual.select({


data:[
{
entity_id:entityId,
start_residue_number:residueNumber,
end_residue_number:residueNumber,
color:{r:20, y:100, b:200},
focus:false},


],

})
})


document.addEventListener('PDB.topologyViewer.mouseover', (e)=>{
var pdbeMolstar=document.getElementById("PdbeMolstarComponent")
var molstar= pdbeMolstar.viewerInstance;


var chainId=e.eventData.chainId;
var entityId=e.eventData.entityId;
var residueNumber=e.eventData.residueNumber;
var types=e.eventData.type;

molstar.visual.highlight({


data:[
{
entity_id:entityId,
start_residue_number:residueNumber,
end_residue_number:residueNumber,
},


],

})
})

 var PdbeMolstarComponent = document.getElementById("PdbeMolstarComponent");


 var viewerInstance = PdbeMolstarComponent.viewerInstance;


        </script>
		

		
  </body>

</html>
