{% load static %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

 <script>


</script>
<script src="{% static "alignments/vue.js" %}">
</script>

<div class="container">
	<h4>Select phylogenetic groups for TwinCons<br/></h4>
	<div id="app">
		Select two taxgroups:
	<tree-menu 
			   :nodes="tree.nodes" 
			   :depth="0"   
			   :label="tree.label"
			   ></tree-menu>
	</div>
  </div>
  
  <script type="text/x-template" id="tree-menu">
	<div class="tree-menu">
	  <div class="label-wrapper" @click="toggleChildren">
		<div :style="indent" :class="labelClasses">
			<i v-for="node in nodes" class="fa" :class="iconClasses"></i>
			<!-- [[label]], [[taxID]] -->
			[[label]]
			<input type="checkbox" id="check" name="check" unchecked>
			
		</div>
	  </div>
	  <tree-menu 
		v-if="showChildren"
		v-for="node in nodes"
		v-bind:key="node.id"
		:nodes="node.nodes" 
		:label="node.label"
		:depth="depth + 1"
		:taxID="node.taxID"
	  >
	  </tree-menu>
	</div>
  </script>

<script src={% static 'alignments/tree_menu.js' %}></script>

<script>
	var pdb = null;
function myFunction(alignment_name,aln_type) {
	var
		getAlignment = document.getElementById("getAlignment"),
		parent_taxid1 = getAlignment.getAttribute("value1"),
		parent_taxid2 = getAlignment.getAttribute("value2");
	
	// var res = aln_type.concat(alignment_name).concat("/").concat(parent_taxid2);
	// localhost:8000/alignments/twc-api/uL16/2/2157/511145
	var res = "twincons/" + alignment_name + "/" + parent_taxid1 + "/" + parent_taxid2 + "/" + pdb;
	// alert(res);
	console.log(res);
	window.location.href = res;
}

function myFunction2(pdb_name) {
	pdb = pdb_name;
}

function myFunction3(file_name) {
	window.location.href = "twincons/" + file_name + "/" + pdb
}
</script>

<p>AND</p> 

<select id = "getPDB" onchange="myFunction2(this.value)">
	<option>Select a PDB</option>
	{% for pdb in threeDstructures %}
		<option value={{ pdb.structurename }}>{{ pdb.structurename }}</option>
	{% endfor %}
</select>

<p>AND</p> 

<button value={{ file_name }} onclick="myFunction3(this.value)" method = "post">Use User-Uploaded Fasta

</button> {{file_name}}

<p>OR</p>

<select id="getAlignment" onchange= "myFunction(this.value, 'rProtein/');">
	<option >Select an alignment</option>
	{% for aln in some_Alignments %}
		{%if 'LSU' not in aln.name%}
			<option value={{ aln.name }}>{{ aln.name }}</option>
		{% endif %}
	{% endfor %}
</select>

<p>OR</p>

<select id="getAlignment" onchange= "myFunction(this.value, 'rRNA/');">
	<option value="">Select an rRNA alignment</option>
	{% for aln in some_Alignments %}
		{%if 'LSU' in aln.name%}
			<option value={{ aln.name }}>{{ aln.name }}</option>
		{% endif %}
	{% endfor %}
</select>

